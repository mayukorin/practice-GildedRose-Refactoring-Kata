# Normal Item のドメイン分析

## 1. 振る舞いの整理

### 1.1 主要な振る舞い

- **振る舞い1: 販売期限の減少**
  - Gherkin仕様書: すべてのシナリオで、1日経過すると販売期限が1減少する
  - 分析資料: sellInは毎日-1される（期限まで残り日数を表す）

- **振る舞い2: 品質の劣化（期限内）**
  - Gherkin仕様書: 「販売期限内では毎日品質が1ずつ劣化する」（Scenario: 販売期限内で次の日に品質が1劣化している）
  - 分析資料: sellIn >= 1 のとき、quality -1（quality > 0の場合）

- **振る舞い3: 品質の加速劣化（期限切れ）**
  - Gherkin仕様書: 「販売期限が過ぎると品質が2倍速で劣化する」（Scenario: 販売期限当日/切れで次の日に品質が2劣化している）
  - 分析資料: sellIn <= 0 のとき、quality -2（ただし、quality = 1 の場合は -1 のみ）

- **振る舞い4: 品質の下限制約**
  - Gherkin仕様書: 「すべてのアイテムは品質値が0未満にならない」（共通ルール）
  - 分析資料: quality は 0 未満にならない

### 1.2 振る舞いのパターン

- **sellInの変化パターン**:
  - 毎日必ず-1される
  - 値の下限はない（負の値も取り得る）

- **qualityの変化パターン**:
  - **sellIn >= 1**（期限内）: quality -1
  - **sellIn <= 0**（期限切れ）: quality -2
  - **境界条件**: quality = 1 かつ sellIn <= 0 の場合、quality -1 のみ（-2にならない）

- **特殊ルール**:
  - quality は 0 以上 50 以下（ただし、上限50は通常アイテムでは到達不可）
  - sellIn = 0 の日は「期限当日」だが、実装上は「期限切れ扱い」（quality -2が適用される）

## 2. ドメイン概念の抽出

### 2.1 このアイテムの特徴

- **特徴1: 時間経過による劣化（Degradation over time）**
  - **説明**: 通常アイテムは時間が経つにつれて品質が低下する
  - **具体例**:
    - Gherkin仕様書: 品質が1の通常アイテムが販売期限まであと3日の場合、1日経過すると品質は0になる
    - 分析資料: デシジョンテーブル#1（sellIn > 0, quality >= 2 → quality -1）

- **特徴2: 期限切れによる加速劣化（Accelerated degradation after expiry）**
  - **説明**: 販売期限を過ぎると、品質の劣化速度が2倍になる
  - **具体例**:
    - Gherkin仕様書: 品質が10の通常アイテムが販売期限当日の場合、1日経過すると品質は8になる
    - 分析資料: デシジョンテーブル#4（sellIn <= 0, quality >= 2 → quality -2）

- **特徴3: 品質下限（Quality floor）**
  - **説明**: 品質は0未満にならない
  - **具体例**:
    - Gherkin仕様書: 品質が0の通常アイテムは、期限内でも期限切れでも、次の日になっても品質は0のままである
    - 分析資料: デシジョンテーブル#3, #6（quality = 0 → quality変化なし）

- **特徴4: 境界条件での特殊な振る舞い（Boundary behavior）**
  - **説明**: quality = 1 で期限切れの場合、-2ではなく-1のみ減少する
  - **具体例**:
    - 分析資料: デシジョンテーブル#5（sellIn <= 0, quality = 1 → quality -1）、境界値分析3.2

## 3. 他のアイテムタイプとの比較（メモ）

### 他のアイテムとの共通点
- sellInの減少ルール（毎日-1）は、Sulfuras以外の全アイテムに共通すると予想される
- 品質の上限/下限制約も、共通ルールとして扱われる可能性が高い

### 他のアイテムとの相違点
- **通常アイテムの特徴**: 時間経過で品質が「劣化」する（減少する）
- **予想される他のアイテムの特徴**:
  - Aged Brieは逆に品質が「向上」する可能性がある（チーズは熟成する）
  - Sulfurasは伝説のアイテムで品質が変化しない可能性がある
  - Backstage passesはコンサート日までの日数によって振る舞いが変わる可能性がある

※このセクションの内容は、フェーズ2のクラス設計で活用されます。
