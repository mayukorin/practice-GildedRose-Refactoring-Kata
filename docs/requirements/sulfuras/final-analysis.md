# Sulfuras 確定仕様

このドキュメントは、Sulfurasアイテムタイプの確定仕様を簡潔にまとめたものです。
詳細な分析プロセスは `analysis.md` を参照してください。

## 確定した仕様ルール

### R1: Qualityの不変性（Sulfuras固有）
- **条件**: アイテム名が "Sulfuras, Hand of Ragnaros"
- **処理**: qualityを変更しない
- **結果**: 初期値が保持される（通常は80）

### R2: SellInの不変性（Sulfuras固有）
- **条件**: アイテム名が "Sulfuras, Hand of Ragnaros"
- **処理**: sellInを変更しない
- **結果**: 初期値が保持される

### R3: 品質の上限例外（Sulfuras固有）
- **制約**: 共通ルール「quality ≤ 50」の例外
- **Sulfurasの品質**: 80（50を超える）
- **理由**: 伝説のアイテムとしての特別扱い

## 重要な決定事項

### 初期品質値の扱い

**決定**: 品質80を前提条件として扱う

**理由**:
1. 要件文には「Quality値は80である」と明記されている
2. コードでは品質を変更しない実装のみで、80に設定する処理はない
3. 「Quality値が変わることはありません」という記述は、「変化しない」を意味する
4. Itemクラスは変更禁止のため、検証や修正ができない

**テスト方針**:
- Sulfurasは品質80で作成されることを前提とする
- 品質80以外で作成された場合の動作は未定義（テスト対象外）

### sellInの扱い

**決定**: sellInの初期値は任意、減らないことのみ確認

**理由**:
1. 要件では「販売されない」とのみ記載
2. sellInの初期値や範囲に関する制約はない
3. コードではsellInを減らさない実装のみ

**テスト方針**:
- 任意のsellIn値でテストを実施
- sellInが減らないことを確認すれば十分

### 品質の上限（50）の適用

**決定**: Sulfurasは品質50の上限の例外

**理由**:
1. 要件文に「Quality値は80である」と明記
2. 共通ルール「Quality値は50以上にはなりません」の後に、Sulfuras固有の記述がある
3. 伝説のアイテムとしての特別扱い

## 境界条件の確定

| 初期状態 | sellIn | quality | 1日後 sellIn | 1日後 quality | 説明 |
|---------|--------|---------|-------------|--------------|------|
| 標準 | 0 | 80 | 0 | 80 | 変化なし |
| 正のsellIn | 5 | 80 | 5 | 80 | 変化なし |
| 負のsellIn | -1 | 80 | -1 | 80 | 変化なし |

**注**: 上記は品質80の標準的なSulfurasの場合。品質80以外で作成された場合の動作は未定義。

## 処理フロー

```
毎日の処理:
  IF アイテム名 == "Sulfuras, Hand of Ragnaros" THEN
    何もしない（quality、sellInともに変更なし）
  END IF
```

**実装の特徴**:
- 通常の品質劣化処理から除外（GildedRose.java:15-17）
- sellIn減少処理から除外（GildedRose.java:39-41）
- 期限切れ後の追加劣化処理から除外（GildedRose.java:47-49）

## 次フェーズへの引き継ぎ事項

### フェーズ2（振る舞いの形式化）に向けて

Sulfurasは他のアイテムと異なり、**状態遷移がない**（不変）ため、以下のパターンで十分：

1. **基本パターン**:
   - 1日経過しても変化なし
   - 複数日経過しても変化なし

2. **境界値パターン**:
   - sellIn = 0 での処理
   - sellIn < 0 での処理
   - sellIn > 0 での処理

3. **エッジケース**:
   - 初期品質が80であることの確認
   - sellInの値に関わらず不変であることの確認

### 状態遷移図で表現すべき状態

Sulfurasには状態遷移がないため、単一の状態のみ：
- **不変状態**（quality = 80, sellInは任意、どちらも変化なし）

### 注意点

- Sulfurasは他のアイテムタイプと根本的に異なる（例外処理）
- テストでは「変化しないこと」を確認する
- 品質80での作成を前提とする（初期値検証は行わない）

## 参照

- 詳細な分析プロセス: `analysis.md`
- 元の要件文: `GildedRoseRequirements_jp.md:22, 33`
- 実装コード: `Java/src/main/java/com/gildedrose/GildedRose.java:15, 39, 47`
- 通常アイテムの仕様: `docs/requirements/normal-item/final-analysis.md`
- Aged Brieの仕様: `docs/requirements/aged-brie/final-analysis.md`
